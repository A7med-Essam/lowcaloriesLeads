<div class="card">
  <p-table [value]="agents" [lazy]="true">
    <ng-template pTemplate="caption">
      <h5 class="mb-4">Agent Table</h5>
      <div class="input-group no-border">
        <input type="text" value="" placeholder="Search..." class="form-control" #searchInput
          (keydown)="search(searchInput)">
          <p-dropdown [options]="agentRoles"
          (onChange)="onAgentRoleSelected(agentRolesDropDown)"
          #agentRolesDropDown appendTo="body" styleClass="w-100" placeholder="Select Role"></p-dropdown>
      </div>
    </ng-template>
    <ng-template pTemplate="header">
      <tr>
        <th>#</th>
        <th>Name</th>
        <th>team</th>
        <th>Role</th>
        <th>Related To</th>
        <th>status</th>
        <th>permissions</th>
        <th>Action</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-user let-rowIndex="rowIndex">
      <tr>
        <td>{{rowIndex + 1}}</td>
        <td>{{user.name}}</td>
        <td>{{user.team}}</td>
        <td>
          {{user.role}}
        </td>
        <td>
          <div class="" *ngFor="let role of user.web_role">
            {{role}}
          </div>
        </td>
        <td>{{user.status?user.status:'Offline'}}</td>
        <td [width]="750">
          <div class="row" *ngIf="user.role_name != 'super_admin'">
            <div class="col-4" *ngFor="let permission of user.permissions">
              {{permission?.permission}}
            </div>
          </div>
        </td>
        <td>
          <div *ngIf="user.role_name != 'super_admin'">
            <button pButton type="button" icon="pi pi-plus" (click)="getCurrentAgent(user)" class="m-1 p-button-sm p-button-success"></button>
            <button pButton type="button" icon="pi pi-pencil" (click)="updateAgent(user)"
              class="m-1 p-button-sm p-button-warning"></button>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<p-dialog header="Add User Role Modal" [(visible)]="addRoleModal" [modal]="true" [style]="{width: '50vw'}"
  [draggable]="false" [resizable]="false">
  <div class="container">
    <!-- <p-dropdown [options]="roles" optionLabel="name" appendTo="body" #RoleDropDown
      styleClass="w-100" placeholder="Select Role" [filter]="true">
    </p-dropdown> -->
    <p-multiSelect [options]="roles" appendTo="body" optionLabel="name" #multieSelectRoles
    defaultLabel="Select Roles" styleClass="w-100" display="chip">
    </p-multiSelect>
  </div>
  <ng-template pTemplate="footer">
    <div class="upload-btn-wrapper">
      <button class="btn btn-primary" (click)="addRole(multieSelectRoles)">Add Role</button>
    </div>
  </ng-template>
</p-dialog>